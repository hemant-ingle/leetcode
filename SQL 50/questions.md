# [Leetcode - SQL 50](https://leetcode.com/studyplan/top-sql-50/)
| S.No. | Question | Status | Difficulty | Remarks | Solution |
| :---: | -------- | :----: | :--------: | ------- | -------- |
| 1. | [**1757. Recyclable and Low Fat Products**](https://leetcode.com/problems/recyclable-and-low-fat-products/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select product_id from products where low_fats='Y' and recyclable='Y';<code><pre></details> |
| 2. | [**584. Find Customer Referee**](https://leetcode.com/problems/find-customer-referee/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Comparison Functions and Operators](https://www.postgresql.org/docs/current/functions-comparison.html#:~:text=datatype%20IS%20DISTINCT%20FROM%20datatype%20%E2%86%92,f%20(rather%20than%20NULL)) | <details><summary>Click to view solution :eyes:</summary><pre><code>select name from customer where referee_id is distinct from 2;<code><pre></details> |
| 3. | [**595. Big Countries**](https://leetcode.com/problems/big-countries/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, population, area from world where area >= 3000000 or population>=25000000;<code><pre></details> |
| 4. | [**1148. Article Views I**](https://leetcode.com/problems/article-views-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select distinct author_id as id from views where author_id=viewer_id;<code><pre></details> |
| 5. | [**1683. Invalid Tweets**](https://leetcode.com/problems/invalid-tweets/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select tweet_id from tweets where length(content)>15;<code><pre></details> |
| 6. | [**1378. Replace Employee ID With The Unique Identifier**](https://leetcode.com/problems/replace-employee-id-with-the-unique-identifier/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, bonus from employee left join bonus on employee.empid=bonus.empid where coalesce(bonus,0)<1000;<code><pre></details> |
| 7. | [**1068. Product Sales Analysis I**](https://leetcode.com/problems/product-sales-analysis-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select p.product_name as product_name, s.year as year, s.price as price from sales s inner join product p on s.product_id=p.product_id;<code><pre></details> |
| 8. | [**1581. Customer Who Visited but Did Not Make Any Transactions**](https://leetcode.com/problems/customer-who-visited-but-did-not-make-any-transactions/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select customer_id,count(customer_id) as count_no_trans from visits left join transactions on visits.visit_id=transactions.visit_id where transaction_id is null group by customer_id;<code><pre></details> |
| 9. | [**197. Rising Temperature**](https://leetcode.com/problems/rising-temperature/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Date/Time Functions and Operators](https://www.postgresql.org/docs/current/functions-datetime.html) | <details><summary>Click to view solution :eyes:</summary><pre><code>select current.id as id from weather current inner join weather previous on current.recorddate=(previous.recorddate + 1) where current.temperature>previous.temperature;<code><pre></details> |
| 10. | [**1661. Average Time of Process per Machine**](https://leetcode.com/problems/average-time-of-process-per-machine/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Functions and Operators](https://www.postgresql.org/docs/8.1/functions-math.html#:~:text=round\(v,42.44) | <details><summary>Click to view solution :eyes:</summary><pre><code>select start_time.machine_id as machine_id, round(avg(end_time.timestamp - start_time.timestamp)::numeric,3) as processing_time from activity start_time inner join activity end_time on start_time.machine_id=end_time.machine_id and start_time.process_id=end_time.process_id and start_time.activity_type='start' and end_time.activity_type='end' group by start_time.machine_id;<code><pre></details> |
| 11. | [**577. Employee Bonus**](https://leetcode.com/problems/employee-bonus/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres -  Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=The%20USING%20clause,.b.)<br> - [Postgres - Conditional Expressions](https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL) | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, bonus from employee left join bonus using (empid) where coalesce(bonus,0)<1000;<code><pre></details> |
| 12. | [**1280. Students and Examinations**](https://leetcode.com/problems/students-and-examinations/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=Join%20Types-,Cross%20join,-T1%20CROSS%20JOIN) | <details><summary>Click to view solution :eyes:</summary><pre><code>select stu.student_id as student_id, stu.student_name as student_name, sub.subject_name as subject_name, count(exam.subject_name) as attended_exams from students stu cross join subjects sub left join examinations exam on stu.student_id=exam.student_id and sub.subject_name=exam.subject_name group by exam.subject_name, stu.student_id, stu.student_name, sub.subject_name order by stu.student_id, sub.subject_name;<code><pre></details> |
| 13. | [**570. Managers with at Least 5 Direct Reports**](https://leetcode.com/problems/managers-with-at-least-5-direct-reports/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select manager.name as name from employee employee inner join employee manager on employee.managerId=manager.id group by manager.id, manager.name having count(employee.id)>=5;<code><pre></details> |
| 14. | [**1934. Confirmation Rate**](https://leetcode.com/problems/confirmation-rate/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select s.user_id as user_id,round(avg(coalesce((c.action='confirmed')::int,0))::numeric, 2) as confirmation_rate from signups s left join confirmations c on s.user_id=c.user_id group by s.user_id;<code><pre></details> |
| 15. | [**620. Not Boring Movies**](https://leetcode.com/problems/not-boring-movies/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select * from cinema where id%2<>0 and description <> 'boring' order by rating desc;<code><pre></details> |
| 16. | [**1251. Average Selling Price**](https://leetcode.com/problems/average-selling-price/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=7.2.1.1.%C2%A0Joined%20Tables) | <details><summary>Click to view solution :eyes:</summary><pre><code>select p.product_id as product_id, round((sum(price*coalesce(units,0))::numeric/coalesce(sum(units),1)),2) as average_price from prices p left join unitssold u on p.product_id=u.product_id and u.purchase_date>=p.start_date and u.purchase_date<=p.end_date group by p.product_id;<code><pre></details> |
| 17. | [**1075. Project Employees I**](https://leetcode.com/problems/project-employees-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select project_id, round(avg(experience_years)::numeric, 2) as average_years from project inner join employee using (employee_id) group by project_id;<code><pre></details> |
| 18. | [**1633. Percentage of Users Attended a Contest**](https://leetcode.com/problems/percentage-of-users-attended-a-contest/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select contest_id, round((count(user_id)::numeric*100)/(select count(user_id) from users), 2) as percentage from register group by contest_id order by percentage desc, contest_id asc;<code><pre></details> |
| 19. | [**1211. Queries Quality and Percentage**](https://leetcode.com/problems/queries-quality-and-percentage/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Value Expressions](https://www.postgresql.org/docs/current/sql-expressions.html#:~:text=Section%C2%A08.16.5.-,4.2.7.%C2%A0Aggregate%20Expressions,-%23) | <details><summary>Click to view solution :eyes:</summary><pre><code>select query_name, round(avg(rating::numeric/position), 2)  as quality, round(((count(rating) filter (where rating<3))::numeric * 100)/count(rating), 2) as poor_query_percentage from queries group by query_name;<code><pre></details> |
| 20. | [**1193. Monthly Transactions I**](https://leetcode.com/problems/monthly-transactions-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select (extract(year from trans_date) \|\| '-'  \|\| lpad(extract(month from trans_date)::varchar,2,'0')) as month, country, count(*) as trans_count, count(*) filter (where state='approved') as approved_count, sum(amount) as trans_total_amount, coalesce(sum(amount) filter (where state='approved'), 0) as approved_total_amount from transactions group by month, country;<code><pre></details> |
| 21. | [**1174. Immediate Food Delivery II**](https://leetcode.com/problems/immediate-food-delivery-ii/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with t as (select *, row_number() over (partition by customer_id order by order_date asc) as rn from delivery), customer_first_order as (select * from t where rn=1) select round(avg(case when order_date=customer_pref_delivery_date then 1 else 0 end) * 100.0, 2) as immediate_percentage from customer_first_order;<code><pre></details> |
| 22. | [**550. Game Play Analysis IV**](https://leetcode.com/problems/game-play-analysis-iv/description/?source=submission-noac) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with player_first_login as (select *, row_number() over (partition by player_id order by event_date) as rn from activity), player_count as (select count(*) as count from player_first_login p where rn=1 and exists(select 1 from activity a where a.player_id=p.player_id and a.event_date=(p.event_date + 1))) select round((select count from player_count)::numeric/count(distinct player_id), 2) as fraction from activity;<code><pre></details> |
| 23. | [**2356. Number of Unique Subjects Taught by Each Teacher**](https://leetcode.com/problems/number-of-unique-subjects-taught-by-each-teacher/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select teacher_id, count(distinct subject_id) as cnt from teacher group by teacher_id;<code><pre></details> |
| 24. | [**1141. User Activity for the Past 30 Days I**](https://leetcode.com/problems/user-activity-for-the-past-30-days-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select activity_date as day, count(distinct user_id) as active_users from activity where activity_date between '2019-07-27'::date - 29 and '2019-07-27'::date group by day;<code><pre></details> |
| 25. | [**1070. Product Sales Analysis III**](https://leetcode.com/problems/product-sales-analysis-iii/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with sales_row_number as (select *, rank() over (partition by product_id order by year) as rnk from sales), sales_first_year as (select product_id, year as first_year, quantity, price from sales_row_number where rnk=1) select * from sales_first_year;<code><pre></details> |
| 26. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 27. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 28. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 29. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 30. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 31. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 32. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 33. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 34. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 35. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 36. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 37. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 38. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 39. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 40. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 41. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 42. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 43. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 44. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 45. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 46. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 47. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 48. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 49. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 50. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
