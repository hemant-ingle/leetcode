# [Leetcode - SQL 50](https://leetcode.com/studyplan/top-sql-50/)
| S.No. | Question | Status | Difficulty | Remarks | Solution |
| :---: | -------- | :----: | :--------: | ------- | -------- |
| 1. | [**1757. Recyclable and Low Fat Products**](https://leetcode.com/problems/recyclable-and-low-fat-products/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select product_id from products where low_fats='Y' and recyclable='Y';<code><pre></details> |
| 2. | [**584. Find Customer Referee**](https://leetcode.com/problems/find-customer-referee/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Comparison Functions and Operators](https://www.postgresql.org/docs/current/functions-comparison.html#:~:text=datatype%20IS%20DISTINCT%20FROM%20datatype%20%E2%86%92,f%20(rather%20than%20NULL)) | <details><summary>Click to view solution :eyes:</summary><pre><code>select name from customer where referee_id is distinct from 2;<code><pre></details> |
| 3. | [**595. Big Countries**](https://leetcode.com/problems/big-countries/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, population, area from world where area >= 3000000 or population>=25000000;<code><pre></details> |
| 4. | [**1148. Article Views I**](https://leetcode.com/problems/article-views-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select distinct author_id as id from views where author_id=viewer_id;<code><pre></details> |
| 5. | [**1683. Invalid Tweets**](https://leetcode.com/problems/invalid-tweets/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select tweet_id from tweets where length(content)>15;<code><pre></details> |
| 6. | [**1378. Replace Employee ID With The Unique Identifier**](https://leetcode.com/problems/replace-employee-id-with-the-unique-identifier/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, bonus from employee left join bonus on employee.empid=bonus.empid where coalesce(bonus,0)<1000;<code><pre></details> |
| 7. | [**1068. Product Sales Analysis I**](https://leetcode.com/problems/product-sales-analysis-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select p.product_name as product_name, s.year as year, s.price as price from sales s inner join product p on s.product_id=p.product_id;<code><pre></details> |
| 8. | [**1581. Customer Who Visited but Did Not Make Any Transactions**](https://leetcode.com/problems/customer-who-visited-but-did-not-make-any-transactions/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select customer_id,count(customer_id) as count_no_trans from visits left join transactions on visits.visit_id=transactions.visit_id where transaction_id is null group by customer_id;<code><pre></details> |
| 9. | [**197. Rising Temperature**](https://leetcode.com/problems/rising-temperature/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Date/Time Functions and Operators](https://www.postgresql.org/docs/current/functions-datetime.html) | <details><summary>Click to view solution :eyes:</summary><pre><code>select current.id as id from weather current inner join weather previous on current.recorddate=(previous.recorddate + 1) where current.temperature>previous.temperature;<code><pre></details> |
| 10. | [**1661. Average Time of Process per Machine**](https://leetcode.com/problems/average-time-of-process-per-machine/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres - Functions and Operators](https://www.postgresql.org/docs/8.1/functions-math.html#:~:text=round\(v,42.44) | <details><summary>Click to view solution :eyes:</summary><pre><code>select start_time.machine_id as machine_id, round(avg(end_time.timestamp - start_time.timestamp)::numeric,3) as processing_time from activity start_time inner join activity end_time on start_time.machine_id=end_time.machine_id and start_time.process_id=end_time.process_id and start_time.activity_type='start' and end_time.activity_type='end' group by start_time.machine_id;<code><pre></details> |
| 11. | [**577. Employee Bonus**](https://leetcode.com/problems/employee-bonus/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: - [Postgres -  Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=The%20USING%20clause,.b.)<br> - [Postgres - Conditional Expressions](https://www.postgresql.org/docs/current/functions-conditional.html#FUNCTIONS-COALESCE-NVL-IFNULL) | <details><summary>Click to view solution :eyes:</summary><pre><code>select name, bonus from employee left join bonus using (empid) where coalesce(bonus,0)<1000;<code><pre></details> |
| 12. | [**1280. Students and Examinations**](https://leetcode.com/problems/students-and-examinations/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=Join%20Types-,Cross%20join,-T1%20CROSS%20JOIN) | <details><summary>Click to view solution :eyes:</summary><pre><code>select stu.student_id as student_id, stu.student_name as student_name, sub.subject_name as subject_name, count(exam.subject_name) as attended_exams from students stu cross join subjects sub left join examinations exam on stu.student_id=exam.student_id and sub.subject_name=exam.subject_name group by exam.subject_name, stu.student_id, stu.student_name, sub.subject_name order by stu.student_id, sub.subject_name;<code><pre></details> |
| 13. | [**570. Managers with at Least 5 Direct Reports**](https://leetcode.com/problems/managers-with-at-least-5-direct-reports/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select manager.name as name from employee employee inner join employee manager on employee.managerId=manager.id group by manager.id, manager.name having count(employee.id)>=5;<code><pre></details> |
| 14. | [**1934. Confirmation Rate**](https://leetcode.com/problems/confirmation-rate/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select s.user_id as user_id,round(avg(coalesce((c.action='confirmed')::int,0))::numeric, 2) as confirmation_rate from signups s left join confirmations c on s.user_id=c.user_id group by s.user_id;<code><pre></details> |
| 15. | [**620. Not Boring Movies**](https://leetcode.com/problems/not-boring-movies/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select * from cinema where id%2<>0 and description <> 'boring' order by rating desc;<code><pre></details> |
| 16. | [**1251. Average Selling Price**](https://leetcode.com/problems/average-selling-price/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Table Expressions](https://www.postgresql.org/docs/current/queries-table-expressions.html#:~:text=7.2.1.1.%C2%A0Joined%20Tables) | <details><summary>Click to view solution :eyes:</summary><pre><code>select p.product_id as product_id, round((sum(price*coalesce(units,0))::numeric/coalesce(sum(units),1)),2) as average_price from prices p left join unitssold u on p.product_id=u.product_id and u.purchase_date>=p.start_date and u.purchase_date<=p.end_date group by p.product_id;<code><pre></details> |
| 17. | [**1075. Project Employees I**](https://leetcode.com/problems/project-employees-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select project_id, round(avg(experience_years)::numeric, 2) as average_years from project inner join employee using (employee_id) group by project_id;<code><pre></details> |
| 18. | [**1633. Percentage of Users Attended a Contest**](https://leetcode.com/problems/percentage-of-users-attended-a-contest/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select contest_id, round((count(user_id)::numeric*100)/(select count(user_id) from users), 2) as percentage from register group by contest_id order by percentage desc, contest_id asc;<code><pre></details> |
| 19. | [**1211. Queries Quality and Percentage**](https://leetcode.com/problems/queries-quality-and-percentage/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | :star_struck: [Postgres - Value Expressions](https://www.postgresql.org/docs/current/sql-expressions.html#:~:text=Section%C2%A08.16.5.-,4.2.7.%C2%A0Aggregate%20Expressions,-%23) | <details><summary>Click to view solution :eyes:</summary><pre><code>select query_name, round(avg(rating::numeric/position), 2)  as quality, round(((count(rating) filter (where rating<3))::numeric * 100)/count(rating), 2) as poor_query_percentage from queries group by query_name;<code><pre></details> |
| 20. | [**1193. Monthly Transactions I**](https://leetcode.com/problems/monthly-transactions-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select (extract(year from trans_date) \|\| '-'  \|\| lpad(extract(month from trans_date)::varchar,2,'0')) as month, country, count(*) as trans_count, count(*) filter (where state='approved') as approved_count, sum(amount) as trans_total_amount, coalesce(sum(amount) filter (where state='approved'), 0) as approved_total_amount from transactions group by month, country;<code><pre></details> |
| 21. | [**1174. Immediate Food Delivery II**](https://leetcode.com/problems/immediate-food-delivery-ii/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with t as (select *, row_number() over (partition by customer_id order by order_date asc) as rn from delivery), customer_first_order as (select * from t where rn=1) select round(avg(case when order_date=customer_pref_delivery_date then 1 else 0 end) * 100.0, 2) as immediate_percentage from customer_first_order;<code><pre></details> |
| 22. | [**550. Game Play Analysis IV**](https://leetcode.com/problems/game-play-analysis-iv/description/?source=submission-noac) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with player_first_login as (select *, row_number() over (partition by player_id order by event_date) as rn from activity), player_count as (select count(*) as count from player_first_login p where rn=1 and exists(select 1 from activity a where a.player_id=p.player_id and a.event_date=(p.event_date + 1))) select round((select count from player_count)::numeric/count(distinct player_id), 2) as fraction from activity;<code><pre></details> |
| 23. | [**2356. Number of Unique Subjects Taught by Each Teacher**](https://leetcode.com/problems/number-of-unique-subjects-taught-by-each-teacher/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select teacher_id, count(distinct subject_id) as cnt from teacher group by teacher_id;<code><pre></details> |
| 24. | [**1141. User Activity for the Past 30 Days I**](https://leetcode.com/problems/user-activity-for-the-past-30-days-i/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select activity_date as day, count(distinct user_id) as active_users from activity where activity_date between '2019-07-27'::date - 29 and '2019-07-27'::date group by day;<code><pre></details> |
| 25. | [**1070. Product Sales Analysis III**](https://leetcode.com/problems/product-sales-analysis-iii/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with sales_row_number as (select *, rank() over (partition by product_id order by year) as rnk from sales), sales_first_year as (select product_id, year as first_year, quantity, price from sales_row_number where rnk=1) select * from sales_first_year;<code><pre></details> |
| 26. | [**596. Classes More Than 5 Students**](https://leetcode.com/problems/classes-more-than-5-students/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select class from courses group by class having count(student)>=5;<code><pre></details> |
| 27. | [**1729. Find Followers Count**](https://leetcode.com/problems/find-followers-count/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select user_id, count(follower_id) as followers_count from followers group by user_id order by user_id;<code><pre></details> |
| 28. | [**619. Biggest Single Number**](https://leetcode.com/problems/biggest-single-number/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select coalesce((select num from mynumbers group by num having count(num)=1 order by num desc limit 1), null) as num;<code><pre></details> |
| 29. | [**1045. Customers Who Bought All Products**](https://leetcode.com/problems/customers-who-bought-all-products/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select customer_id from customer group by customer_id having count(distinct product_key)=(select count(distinct product_key) from product);<code><pre></details> |
| 30. | [**1731. The Number of Employees Which Report to Each Employee**](https://leetcode.com/problems/the-number-of-employees-which-report-to-each-employee/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select m.employee_id as employee_id, m.name as name, count(e.employee_id) as reports_count, round(avg(e.age)) as average_age from employees m left join employees e on m.employee_id=e.reports_to group by m.employee_id, m.name having count(e.employee_id)>0 order by m.employee_id;<code><pre></details> |
| 31. | [**1789. Primary Department for Each Employee**](https://leetcode.com/problems/primary-department-for-each-employee/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with primary_department as (select employee_id, department_id, row_number() over (partition by employee_id order by primary_flag desc) as rn from employee) select employee_id, department_id from primary_department where rn=1;<code><pre></details> |
| 32. | [**610. Triangle Judgement**](https://leetcode.com/problems/triangle-judgement/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select x, y, z, case when ((x+y>z) and (x+z>y) and (y+z>x)) then 'Yes' else 'No' end as triangle from triangle;<code><pre></details> |
| 33. | [**180. Consecutive Numbers**](https://leetcode.com/problems/consecutive-numbers/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | :cyclone: - Do it again: use lead and lag window functions | <details><summary>Click to view solution :eyes:</summary><pre><code>select distinct num as "ConsecutiveNums" from logs l1 where exists(select 1 from logs l2 where l2.id=l1.id+1 and l2.num=l1.num) and exists(select 1 from logs l3 where l3.id=l1.id+2 and l3.num=l1.num);<code><pre></details> |
| 34. | [**1164. Product Price at a Given Date**](https://leetcode.com/problems/product-price-at-a-given-date/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with product_before_16_08_2019 as (select distinct p1.product_id, p2.new_price, p2.change_date from products p1 left join products p2 on p1.product_id=p2.product_id and p2.change_date<='2019-08-16'), product_on_16_08_2019 as (select *, row_number() over (partition by product_id order by change_date desc) as rn from product_before_16_08_2019) select product_id, coalesce(new_price, 10) as price from product_on_16_08_2019 where rn=1;<code><pre></details> |
| 35. | [**1204. Last Person to Fit in the Bus**](https://leetcode.com/problems/last-person-to-fit-in-the-bus/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | :star_struck: [Postgres -  Window Functions](https://www.postgresql.org/docs/current/tutorial-window.html#:~:text=By%20default%2C%20if%20ORDER%20BY%20is%20supplied%20then%20the%20frame%20consists%20of%20all%20rows%20from%20the%20start%20of%20the%20partition%20up%20through%20the%20current%20row%2C%20plus%20any%20following%20rows%20that%20are%20equal%20to%20the%20current%20row%20according%20to%20the%20ORDER%20BY%20clause.) | <details><summary>Click to view solution :eyes:</summary><pre><code>with t as (select person_name, turn, sum(weight) over (order by turn) as cumulative_weight from queue) select person_name from t where cumulative_weight<=1000 order by turn desc limit 1;<code><pre></details> |
| 36. | [**1907. Count Salary Categories**](https://leetcode.com/problems/count-salary-categories/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>with accounts_with_category as (select count(account_id) filter (where income<20000) as low_salary_count, count(account_id) filter (where income>=20000 and income<=50000) as average_salary_count, count(account_id) filter (where income>50000) as high_salary_count from accounts) select 'Low Salary' as category, low_salary_count as accounts_count from accounts_with_category union select 'Average Salary' as category, average_salary_count as accounts_count from accounts_with_category union select 'High Salary' as categroy, high_salary_count as accounts_count from accounts_with_category;<code><pre></details> |
| 37. | [**1978. Employees Whose Manager Left the Company**](https://leetcode.com/problems/employees-whose-manager-left-the-company/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star: | | <details><summary>Click to view solution :eyes:</summary><pre><code>select employee_id from employees where salary<30000 and manager_id not in (select employee_id from employees) order by employee_id;<code><pre></details> |
| 38. | [**626. Exchange Seats**](https://leetcode.com/problems/exchange-seats/description/?envType=study-plan-v2&envId=top-sql-50) | :white_check_mark: | :star::star: | :cyclone: - Do it again: use lead and lag window functions | <details><summary>Click to view solution :eyes:</summary><pre><code>with t as (select max(id) as max_value from seat) select case when (select max_value from t)%2!=0 and (select max_value from t)=id then id when id%2=0 then id-1 when id%2!=0 then id+1 end as id, student from seat order by id;<code><pre></details> |
| 39. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 40. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 41. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 42. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 43. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 44. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 45. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 46. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 47. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 48. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 49. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
| 50. | [****]() | [comment]: # (:white_check_mark:) | [comment]: # (:star:) | [comment]: # (:star_struck: []()) | <details><summary>Click to view solution :eyes:</summary><pre><code><code><pre></details> |
